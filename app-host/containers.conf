# Podman container configuration for International Center Services APIs
# This file provides Podman-specific optimizations for Aspire orchestration
# Place in ~/.config/containers/ or reference via CONTAINERS_CONF environment variable

[containers]
# Default container runtime for Services APIs
default_runtime = "crun"

# Enhanced security for medical-grade compliance
seccomp_profile = "/usr/share/containers/seccomp.json"
apparmor_profile = "containers-default-0.54.1"

# Resource management for Services APIs
default_ulimits = [
  "nofile=65536:65536",
  "nproc=4096:4096",
  "memlock=64000000:64000000"
]

# Network configuration optimized for Aspire service discovery
dns_servers = [
  "1.1.1.1",
  "8.8.8.8"
]

# Container image management
pull_policy = "missing"

# Enhanced logging for medical-grade audit requirements
log_driver = "journald"
log_opts = [
  "tag={{.ImageName}}",
  "env=CONTAINER_RUNTIME,OTEL_SERVICE_NAME"
]

# Timezone for consistent logging across Services APIs
tz = "UTC"

# Default network for Services APIs communication
default_net = "international-center-network"

[engine]
# Aspire-compatible container engine settings
runtime = "crun"
events_logger = "journald"

# Enhanced for Services APIs performance
num_locks = 4096

# Container image storage optimized for frequent deployments
image_default_transport = "docker://"
image_parallel_copies = 10

# Network configuration for Aspire service discovery
network_cmd_options = [
  "enable_ipv6=false"
]

# Resource management for Services container workloads
cgroup_manager = "systemd"

[network]
# Network driver for Services APIs inter-communication
default_network = "international-center-network"
default_subnet = "10.89.0.0/24"
default_subnet_pools = [
  {"base" = "10.89.0.0/16", "size" = 24}
]

[secrets]
# Secrets management for Services APIs (database passwords, JWT keys)
driver = "file"

[machine]
# Podman machine configuration for development
cpus = 4
memory = 8192
disk_size = 50

# Enhanced for Services APIs development workflow  
image = "docker.io/podman/machine-default:latest"
user = "core"

[storage]
# Storage configuration optimized for Services APIs data
driver = "overlay"

# Performance optimizations for database and cache containers
options = [
  "overlay.mountopt=nodev,metacopy=on",
  "overlay.mount_program=/usr/bin/fuse-overlayfs"
]

# Separate volumes for Services APIs data persistence
volume_path = "/home/tojkuv/.local/share/containers/storage/volumes"

[volumes]
# Default volume driver for Services APIs data persistence
driver = "local"