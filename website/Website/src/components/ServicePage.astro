---
import Layout from '../layouts/Layout.astro';
import { Breadcrumb } from '../components/Breadcrumb';
import { ServiceTreatmentDetails } from '../components/ServiceTreatmentDetails';
import { ServicePageCTA } from '../components/ServicePageCTA';
import { ServiceContent } from '../components/ServiceContent';
import type { ServicePageData } from '../types/api';

export interface Props {
  slug: string;
  serviceData: ServicePageData;
}

const { slug, serviceData } = Astro.props;

// Validate that we have service data
if (!serviceData) {
  throw new Error(`Service data is required for slug: ${slug}`);
}

console.log(`âœ… Rendering service page: ${serviceData.title} (slug: ${slug})`);
console.log(`ðŸ“Š Service coming soon: ${serviceData.isComingSoon ? 'Yes' : 'No'}`);
---

<style>
  .service-page-container {
    overflow: visible !important;
  }
</style>

<Layout title={`${serviceData.title} - International Center`} description={serviceData.description}>
  <main>
    <section class="pb-8">
      <Breadcrumb
        serviceName={serviceData.title}
        title={serviceData.title}
        deliveryModes={serviceData.deliveryModes}
        dynamicBackgroundTargetId="service-page-aside"
        client:load
      />

      <div class="container service-page-container">
        <div class="mt-8 grid gap-12 md:grid-cols-12 md:gap-8">
          <div class="order-2 md:order-none md:col-span-7 md:col-start-1 lg:col-span-8">
            <article class="prose dark:prose-invert mx-auto">
              <div>
                <img
                  src={serviceData.heroImage.src}
                  alt={serviceData.heroImage.alt}
                  class="mb-8 mt-0 aspect-video w-full rounded object-cover"
                />
              </div>

              <ServiceContent serviceData={serviceData} client:load />
            </article>
          </div>

          <div class="order-1 md:order-none md:col-span-5 lg:col-span-4">
            <div class="md:sticky md:top-20">
              <aside id="service-page-aside">
                <ServicePageCTA
                  serviceName={serviceData.title}
                  isComingSoon={serviceData.isComingSoon}
                  client:load
                />
                <ServiceTreatmentDetails
                  className="mt-12 md:mt-8"
                  duration={serviceData.treatmentDetails.duration}
                  availability={serviceData.treatmentDetails.availability}
                  safety={serviceData.treatmentDetails.safety}
                  recovery={serviceData.treatmentDetails.recovery}
                  client:load
                />
              </aside>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>
</Layout>
